{
  "program": {
    "name": "HSPTL_MAIN",
    "format": "free",
    "options": [],
    "files": [],
    "dataStructures": [
      {
        "name": "Main",
        "qualified": true,
        "fields": [
          {
            "name": "CurrScrn",
            "type": {
              "family": "char",
              "length": 6
            }
          },
          {
            "name": "Dep",
            "type": {
              "family": "varchar",
              "length": 20,
              "varying": true
            }
          },
          {
            "name": "Scheme",
            "type": {
              "family": "varchar",
              "length": 15,
              "varying": true
            }
          },
          {
            "name": "SelDate",
            "type": {
              "family": "date"
            }
          },
          {
            "name": "PrsNum",
            "type": {
              "family": "packed",
              "precision": 6,
              "scale": 0,
              "signed": true
            }
          },
          {
            "name": "PatNum",
            "type": {
              "family": "packed",
              "precision": 6,
              "scale": 0,
              "signed": true
            }
          }
        ]
      }
    ],
    "variables": [
      {
        "name": "User",
        "type": {
          "family": "char",
          "length": 10
        },
        "attrs": {
          "inz": "*USER"
        }
      }
    ],
    "prototypes": [
      {
        "name": "FltrPlnng",
        "returns": {
          "family": "likeds",
          "targetName": "Main"
        },
        "params": [
          {
            "name": "io",
            "type": {
              "family": "likeds",
              "targetName": "Main"
            }
          }
        ],
        "extproc": "FLTRPLNNG",
        "export": false
      },
      {
        "name": "DspAfdPlng",
        "returns": {
          "family": "likeds",
          "targetName": "Main"
        },
        "params": [
          {
            "name": "io",
            "type": {
              "family": "likeds",
              "targetName": "Main"
            }
          }
        ],
        "extproc": "DSP_AFD",
        "export": false
      },
      {
        "name": "DspPrsPlng",
        "returns": {
          "family": "likeds",
          "targetName": "Main"
        },
        "params": [
          {
            "name": "io",
            "type": {
              "family": "likeds",
              "targetName": "Main"
            }
          }
        ],
        "extproc": "DSP_PRS",
        "export": false
      },
      {
        "name": "DspMedPlng",
        "returns": {
          "family": "likeds",
          "targetName": "Main"
        },
        "params": [
          {
            "name": "io",
            "type": {
              "family": "likeds",
              "targetName": "Main"
            }
          }
        ],
        "extproc": "DSP_MED",
        "export": false
      }
    ],
    "subroutines": [
      {
        "name": "Initialize",
        "role": "normal",
        "body": [
          {
            "kind": "SSqlDeclareCursor",
            "name": "cDep",
            "text": "SELECT Dept, Scheme FROM UserDefaults WHERE User = :User",
            "into": [
              {
                "kind": "dsField",
                "name": "Dep",
                "qual": [
                  "Main"
                ]
              },
              {
                "kind": "dsField",
                "name": "Scheme",
                "qual": [
                  "Main"
                ]
              }
            ],
            "using": [
              {
                "kind": "variable",
                "name": "User"
              }
            ]
          },
          {
            "kind": "SSqlOpen",
            "cursor": "cDep"
          },
          {
            "kind": "SSqlFetch",
            "cursor": "cDep",
            "into": [
              {
                "kind": "dsField",
                "name": "Dep",
                "qual": [
                  "Main"
                ]
              },
              {
                "kind": "dsField",
                "name": "Scheme",
                "qual": [
                  "Main"
                ]
              }
            ]
          },
          {
            "kind": "SSqlClose",
            "cursor": "cDep"
          }
        ]
      },
      {
        "name": "UpdateUserSettings",
        "role": "normal",
        "body": [
          {
            "kind": "SSqlExec",
            "text": "UPDATE UserDefaults SET Dept=:Main.Dep, Scheme=:Main.Scheme WHERE User=:User",
            "using": [
              {
                "kind": "dsField",
                "name": "Dep",
                "qual": [
                  "Main"
                ]
              },
              {
                "kind": "dsField",
                "name": "Scheme",
                "qual": [
                  "Main"
                ]
              },
              {
                "kind": "variable",
                "name": "User"
              }
            ]
          }
        ]
      }
    ],
    "procedures": [],
    "main": [
      {
        "kind": "SExsr",
        "name": "Initialize"
      },
      {
        "kind": "SWhile",
        "cond": {
          "kind": "EBinary",
          "op": "<>",
          "lhs": {
            "kind": "EVarRef",
            "ref": {
              "kind": "dsField",
              "name": "CurrScrn",
              "qual": [
                "Main"
              ]
            }
          },
          "rhs": {
            "kind": "ELiteral",
            "value": "EXIT"
          }
        },
        "body": [
          {
            "kind": "SSelect",
            "cases": [
              {
                "when": [
                  {
                    "kind": "EBinary",
                    "op": "=",
                    "lhs": {
                      "kind": "EVarRef",
                      "ref": {
                        "kind": "dsField",
                        "name": "CurrScrn",
                        "qual": [
                          "Main"
                        ]
                      }
                    },
                    "rhs": {
                      "kind": "ELiteral",
                      "value": "filter"
                    }
                  }
                ],
                "body": [
                  {
                    "kind": "SAssign",
                    "target": {
                      "kind": "EVarRef",
                      "ref": {
                        "kind": "variable",
                        "name": "Main"
                      }
                    },
                    "value": {
                      "kind": "ECall",
                      "name": "FltrPlnng",
                      "args": [
                        {
                          "kind": "EVarRef",
                          "ref": {
                            "kind": "variable",
                            "name": "Main"
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "when": [
                  {
                    "kind": "EBinary",
                    "op": "=",
                    "lhs": {
                      "kind": "EVarRef",
                      "ref": {
                        "kind": "dsField",
                        "name": "CurrScrn",
                        "qual": [
                          "Main"
                        ]
                      }
                    },
                    "rhs": {
                      "kind": "ELiteral",
                      "value": "AfdPlg"
                    }
                  }
                ],
                "body": [
                  {
                    "kind": "SAssign",
                    "target": {
                      "kind": "EVarRef",
                      "ref": {
                        "kind": "variable",
                        "name": "Main"
                      }
                    },
                    "value": {
                      "kind": "ECall",
                      "name": "DspAfdPlng",
                      "args": [
                        {
                          "kind": "EVarRef",
                          "ref": {
                            "kind": "variable",
                            "name": "Main"
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "when": [
                  {
                    "kind": "EBinary",
                    "op": "=",
                    "lhs": {
                      "kind": "EVarRef",
                      "ref": {
                        "kind": "dsField",
                        "name": "CurrScrn",
                        "qual": [
                          "Main"
                        ]
                      }
                    },
                    "rhs": {
                      "kind": "ELiteral",
                      "value": "PrsPlg"
                    }
                  }
                ],
                "body": [
                  {
                    "kind": "SAssign",
                    "target": {
                      "kind": "EVarRef",
                      "ref": {
                        "kind": "variable",
                        "name": "Main"
                      }
                    },
                    "value": {
                      "kind": "ECall",
                      "name": "DspPrsPlng",
                      "args": [
                        {
                          "kind": "EVarRef",
                          "ref": {
                            "kind": "variable",
                            "name": "Main"
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "when": [
                  {
                    "kind": "EBinary",
                    "op": "=",
                    "lhs": {
                      "kind": "EVarRef",
                      "ref": {
                        "kind": "dsField",
                        "name": "CurrScrn",
                        "qual": [
                          "Main"
                        ]
                      }
                    },
                    "rhs": {
                      "kind": "ELiteral",
                      "value": "MedPlg"
                    }
                  }
                ],
                "body": [
                  {
                    "kind": "SAssign",
                    "target": {
                      "kind": "EVarRef",
                      "ref": {
                        "kind": "variable",
                        "name": "Main"
                      }
                    },
                    "value": {
                      "kind": "ECall",
                      "name": "DspMedPlng",
                      "args": [
                        {
                          "kind": "EVarRef",
                          "ref": {
                            "kind": "variable",
                            "name": "Main"
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "otherwise": true,
                "body": [
                  {
                    "kind": "SAssign",
                    "target": {
                      "kind": "EVarRef",
                      "ref": {
                        "kind": "dsField",
                        "name": "CurrScrn",
                        "qual": [
                          "Main"
                        ]
                      }
                    },
                    "value": {
                      "kind": "ELiteral",
                      "value": "EXIT"
                    }
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "kind": "SExsr",
        "name": "UpdateUserSettings"
      },
      {
        "kind": "SSetLR",
        "value": true
      },
      {
        "kind": "SReturn"
      }
    ],
    "callGraph": {
      "nodes": [
        {
          "id": "prog:HSPTL_MAIN",
          "kind": "program",
          "name": "HSPTL_MAIN"
        },
        {
          "id": "ext:FltrPlnng",
          "kind": "externalProgram",
          "name": "FLTRPLNNG"
        },
        {
          "id": "ext:DspAfdPlng",
          "kind": "externalProgram",
          "name": "DSP_AFD"
        },
        {
          "id": "ext:DspPrsPlng",
          "kind": "externalProgram",
          "name": "DSP_PRS"
        },
        {
          "id": "ext:DspMedPlng",
          "kind": "externalProgram",
          "name": "DSP_MED"
        }
      ],
      "edges": [
        {
          "fromId": "prog:HSPTL_MAIN",
          "toId": "ext:FltrPlnng"
        },
        {
          "fromId": "prog:HSPTL_MAIN",
          "toId": "ext:DspAfdPlng"
        },
        {
          "fromId": "prog:HSPTL_MAIN",
          "toId": "ext:DspPrsPlng"
        },
        {
          "fromId": "prog:HSPTL_MAIN",
          "toId": "ext:DspMedPlng"
        }
      ]
    }
  }
}